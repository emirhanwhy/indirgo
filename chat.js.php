
<!-- saved from url=(0041)https://www.shoutbox.com/chat/chat.js.php -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body><div class="line-gutter-backdrop"></div><table><tbody><tr><td class="line-number" value="1"></td><td class="line-content">document.write('<span class="html-tag">&lt;link <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">stylesheet</span>" <span class="html-attribute-name">type</span>="<span class="html-attribute-value">text/css</span>" <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://www.shoutbox.com/chat/shoutbox.css" rel="noreferrer noopener">https://www.shoutbox.com/chat/shoutbox.css</a>"&gt;</span>\<span class="html-tag">&lt;link <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">stylesheet</span>" <span class="html-attribute-name">type</span>="<span class="html-attribute-value">text/css</span>" <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://www.shoutbox.com/css/font-awesome.min.css" rel="noreferrer noopener">https://www.shoutbox.com/css/font-awesome.min.css</a>"&gt;</span>\<span class="html-tag">&lt;script <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://www.shoutbox.com/js/sprintf.min.js" rel="noreferrer noopener">https://www.shoutbox.com/js/sprintf.min.js</a>"&gt;</span><span class="html-tag">&lt;/script&gt;</span>\<span class="html-tag">&lt;script <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js" rel="noreferrer noopener">https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js</a>"&gt;</span><span class="html-tag">&lt;/script&gt;</span>\<span class="html-tag">&lt;script <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://www.shoutbox.com/js/socket.io.js" rel="noreferrer noopener">https://www.shoutbox.com/js/socket.io.js</a>"&gt;</span><span class="html-tag">&lt;/script&gt;</span>\<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">shoutBoxContainer</span>"&gt;</span>\    <span class="html-tag">&lt;div <span class="html-attribute-name">id</span>="<span class="html-attribute-value">shoutBoxHeader</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">shoutBoxHeader</span>"&gt;</span>\        <span class="html-tag">&lt;i <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fa fa-users</span>" <span class="html-attribute-name">alt</span>="<span class="html-attribute-value">users online</span>" <span class="html-attribute-name">title</span>="<span class="html-attribute-value">users Online</span>"&gt;</span><span class="html-tag">&lt;/i&gt;</span>\        <span class="html-tag">&lt;div <span class="html-attribute-name">id</span>="<span class="html-attribute-value">shoutBoxHeaderText</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span>\        <span class="html-tag">&lt;div <span class="html-attribute-name">id</span>="<span class="html-attribute-value">shoutBoxUserList</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span>\    <span class="html-tag">&lt;/div&gt;</span>\    <span class="html-tag">&lt;div <span class="html-attribute-name">id</span> ="<span class="html-attribute-value">shoutChat</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">shoutChat</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span>\    <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">shoutInput</span>"&gt;</span>\        <span class="html-tag">&lt;input <span class="html-attribute-name">class</span>="<span class="html-attribute-value">shoutInputRed</span>" <span class="html-attribute-name">required</span> <span class="html-attribute-name">type</span>="<span class="html-attribute-value">text</span>" <span class="html-attribute-name">id</span>="<span class="html-attribute-value">shoutBoxInput</span>" <span class="html-attribute-name">placeholder</span>="<span class="html-attribute-value">Enter your nickname</span>"&gt;</span>\        <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">adShoutBox</span>"&gt;</span>\            Get your own <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="https://www.shoutbox.com/" rel="noreferrer noopener">//www.shoutbox.com</a>" <span class="html-attribute-name">title</span>="<span class="html-attribute-value">get your free shout box</span>"&gt;</span>free shoutbox<span class="html-tag">&lt;/a&gt;</span>\        <span class="html-tag">&lt;/div&gt;</span>\    <span class="html-tag">&lt;/div&gt;</span>\    <span class="html-tag">&lt;div <span class="html-attribute-name">id</span>="<span class="html-attribute-value">configPanel</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">configPanel</span>"&gt;</span>\    	<span class="html-tag">&lt;div&gt;</span>\        	<span class="html-tag">&lt;div <span class="html-attribute-name">style</span>="<span class="html-attribute-value">margin-left:10px</span>"&gt;</span><span class="html-tag">&lt;label <span class="html-attribute-name">for</span>="<span class="html-attribute-value">emailAdmin</span>"&gt;</span>Shoutbox admin panel<span class="html-tag">&lt;/label&gt;</span><span class="html-tag">&lt;/div&gt;</span>\            <span class="html-tag">&lt;input <span class="html-attribute-name">type</span>="<span class="html-attribute-value">text</span>" <span class="html-attribute-name">placeholder</span>="<span class="html-attribute-value">Enter email</span>" <span class="html-attribute-name">id</span>="<span class="html-attribute-value">emailAdmin</span>" &gt;</span>\        <span class="html-tag">&lt;/div&gt;</span>\        <span class="html-tag">&lt;div&gt;</span>\	        <span class="html-tag">&lt;input <span class="html-attribute-name">type</span>="<span class="html-attribute-value">password</span>" <span class="html-attribute-name">placeholder</span>="<span class="html-attribute-value">Enter password</span>" <span class="html-attribute-name">id</span>="<span class="html-attribute-value">passwordAdmin</span>" &gt;</span>\        <span class="html-tag">&lt;/div&gt;</span>\        <span class="html-tag">&lt;div&gt;</span>\        	<span class="html-tag">&lt;button <span class="html-attribute-name">type</span>="<span class="html-attribute-value">button</span>" <span class="html-attribute-name">id</span>="<span class="html-attribute-value">loginAdminBtn</span>"&gt;</span>Enter as admin<span class="html-tag">&lt;/button&gt;</span>\        <span class="html-tag">&lt;/div&gt;</span>\        <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">error</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span>  \        <span class="html-tag">&lt;div <span class="html-attribute-name">style</span>="<span class="html-attribute-value">text-align:center</span>"&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">id</span>="<span class="html-attribute-value">forgottenBtn</span>"&gt;</span>forgotten password ?<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;/div&gt;</span>\              \	<span class="html-tag">&lt;/div&gt;</span>\    \    <span class="html-tag">&lt;div <span class="html-attribute-name">id</span>="<span class="html-attribute-value">configPanel2</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">configPanel</span>"&gt;</span>\    	<span class="html-tag">&lt;div&gt;</span>\        	<span class="html-tag">&lt;div&gt;</span><span class="html-tag">&lt;label <span class="html-attribute-name">for</span>="<span class="html-attribute-value">changePassword1</span>"&gt;</span>Enter new pasword<span class="html-tag">&lt;/label&gt;</span><span class="html-tag">&lt;/div&gt;</span>\            <span class="html-tag">&lt;div&gt;</span>\                <span class="html-tag">&lt;input <span class="html-attribute-name">type</span>="<span class="html-attribute-value">password</span>" <span class="html-attribute-name">id</span>="<span class="html-attribute-value">changePassword1</span>" <span class="html-attribute-name">placeholder</span>="<span class="html-attribute-value">Enter new password</span>"&gt;</span>\                <span class="html-tag">&lt;input <span class="html-attribute-name">type</span>="<span class="html-attribute-value">password</span>" <span class="html-attribute-name">id</span>="<span class="html-attribute-value">changePassword2</span>" <span class="html-attribute-name">placeholder</span>="<span class="html-attribute-value">Enter new password</span>"&gt;</span>\            <span class="html-tag">&lt;/div&gt;</span>\            <span class="html-tag">&lt;div <span class="html-attribute-name">style</span>="<span class="html-attribute-value">margin-top:15px</span>"&gt;</span><span class="html-tag">&lt;label <span class="html-attribute-name">for</span>="<span class="html-attribute-value">userMustRegister</span>"&gt;</span>User must register before enter shoutbox <span class="html-tag">&lt;input <span class="html-attribute-name">type</span>="<span class="html-attribute-value">checkbox</span>" <span class="html-attribute-name">id</span>="<span class="html-attribute-value">userMustRegister</span>"&gt;</span><span class="html-tag">&lt;/label&gt;</span><span class="html-tag">&lt;/div&gt;</span>\            <span class="html-tag">&lt;div&gt;</span><span class="html-tag">&lt;button <span class="html-attribute-name">type</span>="<span class="html-attribute-value">button</span>" <span class="html-attribute-name">id</span>="<span class="html-attribute-value">saveBtn</span>"&gt;</span>Save config<span class="html-tag">&lt;/button&gt;</span><span class="html-tag">&lt;/div&gt;</span>\            <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">error</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span>         \        <span class="html-tag">&lt;/div&gt;</span>\    <span class="html-tag">&lt;/div&gt;</span>\    \    <span class="html-tag">&lt;div <span class="html-attribute-name">id</span>="<span class="html-attribute-value">forgottenPassword</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">configPanel</span>"&gt;</span>\    	<span class="html-tag">&lt;div&gt;</span>\        	<span class="html-tag">&lt;div&gt;</span><span class="html-tag">&lt;label <span class="html-attribute-name">for</span>="<span class="html-attribute-value">forgottenEmail</span>"&gt;</span>Enter email to get your password back<span class="html-tag">&lt;/label&gt;</span><span class="html-tag">&lt;/div&gt;</span>\            <span class="html-tag">&lt;div&gt;</span><span class="html-tag">&lt;input <span class="html-attribute-name">type</span>="<span class="html-attribute-value">text</span>" <span class="html-attribute-name">required</span> <span class="html-attribute-name">id</span>="<span class="html-attribute-value">forgottenEmail</span>" <span class="html-attribute-name">placeholder</span>="<span class="html-attribute-value">enter your email</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span>\            <span class="html-tag">&lt;div&gt;</span><span class="html-tag">&lt;button <span class="html-attribute-name">id</span>="<span class="html-attribute-value">sendMyPasswordBtn</span>"&gt;</span>Send me my password<span class="html-tag">&lt;/button&gt;</span><span class="html-tag">&lt;/div&gt;</span>\			<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">error</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span>             \        <span class="html-tag">&lt;/div&gt;</span>\    <span class="html-tag">&lt;/div&gt;</span>  \    \    <span class="html-tag">&lt;div <span class="html-attribute-name">id</span>="<span class="html-attribute-value">loginPanel</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">configPanel</span>"&gt;</span>\    	<span class="html-tag">&lt;div&gt;</span>\        	<span class="html-tag">&lt;div&gt;</span>Enter email<span class="html-tag">&lt;/div&gt;</span>\            <span class="html-tag">&lt;div&gt;</span><span class="html-tag">&lt;input <span class="html-attribute-name">type</span>="<span class="html-attribute-value">text</span>" <span class="html-attribute-name">required</span> <span class="html-attribute-name">id</span>="<span class="html-attribute-value">usernameLogin</span>" <span class="html-attribute-name">placeholder</span>="<span class="html-attribute-value">Enter your username or email</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span>\            <span class="html-tag">&lt;div&gt;</span><span class="html-tag">&lt;input <span class="html-attribute-name">type</span>="<span class="html-attribute-value">text</span>" <span class="html-attribute-name">required</span> <span class="html-attribute-name">id</span>="<span class="html-attribute-value">passwordLogin</span>" <span class="html-attribute-name">placeholder</span>="<span class="html-attribute-value">Enter your password</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span>\            <span class="html-tag">&lt;div&gt;</span><span class="html-tag">&lt;button <span class="html-attribute-name">id</span>="<span class="html-attribute-value">sendMyPasswordBtn</span>"&gt;</span>Login<span class="html-tag">&lt;/button&gt;</span><span class="html-tag">&lt;/div&gt;</span>\            <span class="html-tag">&lt;div&gt;</span>\            	<span class="html-tag">&lt;div&gt;</span>Register for new account<span class="html-tag">&lt;/div&gt;</span>\            <span class="html-tag">&lt;/div&gt;</span>\             <span class="html-tag">&lt;div&gt;</span>\            	<span class="html-tag">&lt;div&gt;</span>forgotten password ?<span class="html-tag">&lt;/div&gt;</span>\            <span class="html-tag">&lt;/div&gt;</span>\            <span class="html-tag">&lt;div&gt;</span><span class="html-tag">&lt;input <span class="html-attribute-name">type</span>="<span class="html-attribute-value">text</span>" <span class="html-attribute-name">required</span> <span class="html-attribute-name">id</span>="<span class="html-attribute-value">passwordLogin</span>" <span class="html-attribute-name">placeholder</span>="<span class="html-attribute-value">Enter your password</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span>           \			<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">error</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span>             \        <span class="html-tag">&lt;/div&gt;</span>\    <span class="html-tag">&lt;/div&gt;</span> \    \    <span class="html-tag">&lt;div <span class="html-attribute-name">id</span>="<span class="html-attribute-value">registerPanel</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">configPanel</span>"&gt;</span>\    	<span class="html-tag">&lt;div&gt;</span>\        	<span class="html-tag">&lt;div&gt;</span>Enter email<span class="html-tag">&lt;/div&gt;</span>\            <span class="html-tag">&lt;div&gt;</span><span class="html-tag">&lt;input <span class="html-attribute-name">type</span>="<span class="html-attribute-value">text</span>" <span class="html-attribute-name">required</span> <span class="html-attribute-name">id</span>="<span class="html-attribute-value">usernameRegister</span>" <span class="html-attribute-name">placeholder</span>="<span class="html-attribute-value">Enter your username or email</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span>\            <span class="html-tag">&lt;div&gt;</span><span class="html-tag">&lt;input <span class="html-attribute-name">type</span>="<span class="html-attribute-value">text</span>" <span class="html-attribute-name">required</span> <span class="html-attribute-name">id</span>="<span class="html-attribute-value">passwordRegister</span>" <span class="html-attribute-name">placeholder</span>="<span class="html-attribute-value">Enter your password</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span>\            <span class="html-tag">&lt;div&gt;</span><span class="html-tag">&lt;input <span class="html-attribute-name">type</span>="<span class="html-attribute-value">text</span>" <span class="html-attribute-name">required</span> <span class="html-attribute-name">id</span>="<span class="html-attribute-value">passwordRegister</span>" <span class="html-attribute-name">placeholder</span>="<span class="html-attribute-value">Confirm your password</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span>\            <span class="html-tag">&lt;div&gt;</span><span class="html-tag">&lt;button <span class="html-attribute-name">id</span>="<span class="html-attribute-value">registerBtn</span>"&gt;</span>Register<span class="html-tag">&lt;/button&gt;</span><span class="html-tag">&lt;/div&gt;</span>\            <span class="html-tag">&lt;div&gt;</span><span class="html-tag">&lt;input <span class="html-attribute-name">type</span>="<span class="html-attribute-value">text</span>" <span class="html-attribute-name">required</span> <span class="html-attribute-name">id</span>="<span class="html-attribute-value">passwordLogin</span>" <span class="html-attribute-name">placeholder</span>="<span class="html-attribute-value">Enter your password</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span>           \			<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">error</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span>             \        <span class="html-tag">&lt;/div&gt;</span>\    <span class="html-tag">&lt;/div&gt;</span>  \    \    <span class="html-tag">&lt;div <span class="html-attribute-name">id</span>="<span class="html-attribute-value">forgottenPasswordUser</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">configPanel</span>"&gt;</span>\    	<span class="html-tag">&lt;div&gt;</span>\        	<span class="html-tag">&lt;div&gt;</span><span class="html-tag">&lt;label <span class="html-attribute-name">for</span>="<span class="html-attribute-value">forgottenUserEmail</span>"&gt;</span>Enter email to get your password back<span class="html-tag">&lt;/label&gt;</span><span class="html-tag">&lt;/div&gt;</span>\            <span class="html-tag">&lt;div&gt;</span><span class="html-tag">&lt;input <span class="html-attribute-name">type</span>="<span class="html-attribute-value">text</span>" <span class="html-attribute-name">required</span> <span class="html-attribute-name">id</span>="<span class="html-attribute-value">forgottenUserEmail</span>" <span class="html-attribute-name">placeholder</span>="<span class="html-attribute-value">enter your email</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span>\            <span class="html-tag">&lt;div&gt;</span><span class="html-tag">&lt;button <span class="html-attribute-name">id</span>="<span class="html-attribute-value">sendUserPasswordBtn</span>"&gt;</span>Send me my password<span class="html-tag">&lt;/button&gt;</span><span class="html-tag">&lt;/div&gt;</span>\			<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">error</span>"&gt;</span><span class="html-tag">&lt;/div&gt;</span>             \        <span class="html-tag">&lt;/div&gt;</span>\    <span class="html-tag">&lt;/div&gt;</span>             \    \    \    \    <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">adminCog</span>"&gt;</span>\    	<span class="html-tag">&lt;i <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fa fa-cog</span>" <span class="html-attribute-name">id</span>="<span class="html-attribute-value">shoutBoxAdminImage</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">float:right;margin-top: 2px;</span>" <span class="html-attribute-name">title</span>="<span class="html-attribute-value">login admin</span>"/&gt;</span><span class="html-tag">&lt;/i&gt;</span>\    <span class="html-tag">&lt;/div&gt;</span>\<span class="html-tag">&lt;/div&gt;</span>');</td></tr><tr><td class="line-number" value="2"></td><td class="line-content">var Chat = function(room, username, avatar) {</td></tr><tr><td class="line-number" value="3"></td><td class="line-content">	var server = "https://www.shoutbox.com";</td></tr><tr><td class="line-number" value="4"></td><td class="line-content">	avatar = avatar || "https://www.shoutbox.com/avatars/" + Math.ceil(Math.random()*29) + ".svg";</td></tr><tr><td class="line-number" value="5"></td><td class="line-content">	username = username || '';	</td></tr><tr><td class="line-number" value="6"></td><td class="line-content">	var shoutbox = this;</td></tr><tr><td class="line-number" value="7"></td><td class="line-content">    console.log("init");</td></tr><tr><td class="line-number" value="8"></td><td class="line-content">	this.myUser = {"username":username, "room":room, "avatar":avatar, "password":"", id: new Date().getTime()};</td></tr><tr><td class="line-number" value="9"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="10"></td><td class="line-content"></td></tr><tr><td class="line-number" value="11"></td><td class="line-content">String.prototype.replaceAll = function(target, replacement) {</td></tr><tr><td class="line-number" value="12"></td><td class="line-content">  return this.split(target).join(replacement);</td></tr><tr><td class="line-number" value="13"></td><td class="line-content">};</td></tr><tr><td class="line-number" value="14"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="15"></td><td class="line-content">this.ago = function(date) {</td></tr><tr><td class="line-number" value="16"></td><td class="line-content">    var seconds = Math.floor((new Date() - date) / 1000);</td></tr><tr><td class="line-number" value="17"></td><td class="line-content">    var interval = Math.floor(seconds / 31536000);</td></tr><tr><td class="line-number" value="18"></td><td class="line-content">    if (interval &gt; 0) {</td></tr><tr><td class="line-number" value="19"></td><td class="line-content">        return interval + " y. ago";</td></tr><tr><td class="line-number" value="20"></td><td class="line-content">    }</td></tr><tr><td class="line-number" value="21"></td><td class="line-content">    interval = Math.floor(seconds / 2592000);</td></tr><tr><td class="line-number" value="22"></td><td class="line-content">    if (interval &gt; 0) {</td></tr><tr><td class="line-number" value="23"></td><td class="line-content">        return interval + " mon. ago";</td></tr><tr><td class="line-number" value="24"></td><td class="line-content">    }</td></tr><tr><td class="line-number" value="25"></td><td class="line-content">    interval = Math.floor(seconds / 86400);</td></tr><tr><td class="line-number" value="26"></td><td class="line-content">    if (interval &gt; 0) {</td></tr><tr><td class="line-number" value="27"></td><td class="line-content">        return interval + " d. ago";</td></tr><tr><td class="line-number" value="28"></td><td class="line-content">    }</td></tr><tr><td class="line-number" value="29"></td><td class="line-content">    interval = Math.floor(seconds / 3600);</td></tr><tr><td class="line-number" value="30"></td><td class="line-content">    if (interval &gt; 0) {</td></tr><tr><td class="line-number" value="31"></td><td class="line-content">        return interval + " h ago";</td></tr><tr><td class="line-number" value="32"></td><td class="line-content">    }</td></tr><tr><td class="line-number" value="33"></td><td class="line-content">    interval = Math.floor(seconds / 60);</td></tr><tr><td class="line-number" value="34"></td><td class="line-content">    if (interval &gt; 0) {</td></tr><tr><td class="line-number" value="35"></td><td class="line-content">        return interval + " min. ago";</td></tr><tr><td class="line-number" value="36"></td><td class="line-content">    }</td></tr><tr><td class="line-number" value="37"></td><td class="line-content">	return "now";</td></tr><tr><td class="line-number" value="38"></td><td class="line-content">    //return Math.floor(seconds) + " s ago";</td></tr><tr><td class="line-number" value="39"></td><td class="line-content">};</td></tr><tr><td class="line-number" value="40"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="41"></td><td class="line-content">// traductions</td></tr><tr><td class="line-number" value="42"></td><td class="line-content">	this.traductions = {</td></tr><tr><td class="line-number" value="43"></td><td class="line-content">	welcome:"Welcome %s. <span class="html-tag">&lt;button <span class="html-attribute-name">type</span>='<span class="html-attribute-value">button</span>' <span class="html-attribute-name">class</span>='<span class="html-attribute-value">changeUsernameBtn</span>'&gt;</span>Change username<span class="html-tag">&lt;/button&gt;</span>",</td></tr><tr><td class="line-number" value="44"></td><td class="line-content">	userOnline:"%s user online",</td></tr><tr><td class="line-number" value="45"></td><td class="line-content">	usersOnline:"%s users online",</td></tr><tr><td class="line-number" value="46"></td><td class="line-content">	enterYourTextHere : "Enter your text here",</td></tr><tr><td class="line-number" value="47"></td><td class="line-content">	serverMessage: "<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>='<span class="html-attribute-value">shoutServerText</span>'&gt;</span>%s<span class="html-tag">&lt;/div&gt;</span>",</td></tr><tr><td class="line-number" value="48"></td><td class="line-content">	enterAdminPassword:"Enter admin password",</td></tr><tr><td class="line-number" value="49"></td><td class="line-content">	imageAvatar: "<span class="html-tag">&lt;img <span class="html-attribute-name">src</span>='<a class="html-attribute-value html-resource-link" target="_blank" href="https://www.shoutbox.com/chat/%s" rel="noreferrer noopener">%s</a>' <span class="html-attribute-name">class</span>='<span class="html-attribute-value">shoutBoxAvatar</span>'&gt;</span>",</td></tr><tr><td class="line-number" value="50"></td><td class="line-content">	youAreAdminNow:"You are admin now",</td></tr><tr><td class="line-number" value="51"></td><td class="line-content">	mp3: "https://www.shoutbox.com/chat/dink.mp3",</td></tr><tr><td class="line-number" value="52"></td><td class="line-content">	addUser : "<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>='<span class="html-attribute-value">shoutBoxUserItem</span>' <span class="html-attribute-name">data-id</span>='<span class="html-attribute-value">%s</span>' <span class="html-attribute-name">id</span>='<span class="html-attribute-value">shoutBoxUser%s</span>'&gt;</span>%s %s<span class="html-tag">&lt;/div&gt;</span>",</td></tr><tr><td class="line-number" value="53"></td><td class="line-content">	banText : "<span class="html-tag">&lt;button <span class="html-attribute-name">class</span>='<span class="html-attribute-value">shoutboxBanBtn</span>' <span class="html-attribute-name">alt</span>='<span class="html-attribute-value">Ban all messages from this user</span>' <span class="html-attribute-name">title</span>='<span class="html-attribute-value">Ban all messages from this user</span>'&gt;</span>Ban<span class="html-tag">&lt;/button&gt;</span>",</td></tr><tr><td class="line-number" value="54"></td><td class="line-content">	receivedText:"<span class="html-tag">&lt;div <span class="html-attribute-name">data-id</span>='<span class="html-attribute-value">%s</span>' <span class="html-attribute-name">data-ip</span>='<span class="html-attribute-value">%s</span>' <span class="html-attribute-name">class</span>='<span class="html-attribute-value">shoutText</span>'&gt;</span>%s<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>='<span class="html-attribute-value">shoutDate</span>'&gt;</span>%s <span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>='<span class="html-attribute-value">shoutUserText</span>'&gt;</span>%s<span class="html-tag">&lt;/span&gt;</span>: %s<span class="html-tag">&lt;button <span class="html-attribute-name">class</span>='<span class="html-attribute-value">shoutboxBanBtn</span>'&gt;</span>ban<span class="html-tag">&lt;/button&gt;</span><span class="html-tag">&lt;button <span class="html-attribute-name">class</span>='<span class="html-attribute-value">shoutboxDelBtn</span>'&gt;</span>del<span class="html-tag">&lt;/button&gt;</span><span class="html-tag">&lt;/div&gt;</span>"</td></tr><tr><td class="line-number" value="55"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="56"></td><td class="line-content">};</td></tr><tr><td class="line-number" value="57"></td><td class="line-content">// smileys</td></tr><tr><td class="line-number" value="58"></td><td class="line-content">	this.smileys = {</td></tr><tr><td class="line-number" value="59"></td><td class="line-content">	"(angry)":"<span class="html-tag">&lt;img <span class="html-attribute-name">src</span>='<a class="html-attribute-value html-resource-link" target="_blank" href="https://www.shoutbox.com/chat/smileys/(angry).gif" rel="noreferrer noopener">https://www.shoutbox.com/chat/smileys/(angry).gif</a>'&gt;</span>",</td></tr><tr><td class="line-number" value="60"></td><td class="line-content">	"(lol)":"<span class="html-tag">&lt;img <span class="html-attribute-name">src</span>='<a class="html-attribute-value html-resource-link" target="_blank" href="https://www.shoutbox.com/chat/smileys/(lol).gif" rel="noreferrer noopener">https://www.shoutbox.com/chat/smileys/(lol).gif</a>'&gt;</span>",</td></tr><tr><td class="line-number" value="61"></td><td class="line-content">	"(love)":"<span class="html-tag">&lt;img <span class="html-attribute-name">src</span>='<a class="html-attribute-value html-resource-link" target="_blank" href="https://www.shoutbox.com/chat/smileys/(love).gif" rel="noreferrer noopener">https://www.shoutbox.com/chat/smileys/(love).gif</a>'&gt;</span>",</td></tr><tr><td class="line-number" value="62"></td><td class="line-content">	"(sorry)":"<span class="html-tag">&lt;img <span class="html-attribute-name">src</span>='<a class="html-attribute-value html-resource-link" target="_blank" href="https://www.shoutbox.com/chat/smileys/(sorry).gif" rel="noreferrer noopener">https://www.shoutbox.com/chat/smileys/(sorry).gif</a>'&gt;</span>",</td></tr><tr><td class="line-number" value="63"></td><td class="line-content">	"(why)":"<span class="html-tag">&lt;img <span class="html-attribute-name">src</span>='<a class="html-attribute-value html-resource-link" target="_blank" href="https://www.shoutbox.com/chat/smileys/(why).gif" rel="noreferrer noopener">https://www.shoutbox.com/chat/smileys/(why).gif</a>'&gt;</span>",</td></tr><tr><td class="line-number" value="64"></td><td class="line-content">	":D":"<span class="html-tag">&lt;img <span class="html-attribute-name">src</span>='<a class="html-attribute-value html-resource-link" target="_blank" href="https://www.shoutbox.com/chat/smileys/D).gif" rel="noreferrer noopener">https://www.shoutbox.com/chat/smileys/D).gif</a>'&gt;</span>",</td></tr><tr><td class="line-number" value="65"></td><td class="line-content">	";(":"<span class="html-tag">&lt;img <span class="html-attribute-name">src</span>='<a class="html-attribute-value html-resource-link" target="_blank" href="https://www.shoutbox.com/chat/smileys/;(.gif" rel="noreferrer noopener">https://www.shoutbox.com/chat/smileys/;(.gif</a>'&gt;</span>",</td></tr><tr><td class="line-number" value="66"></td><td class="line-content">	";)":"<span class="html-tag">&lt;img <span class="html-attribute-name">src</span>='<a class="html-attribute-value html-resource-link" target="_blank" href="https://www.shoutbox.com/chat/smileys/(happy).gif" rel="noreferrer noopener">https://www.shoutbox.com/chat/smileys/(happy).gif</a>'&gt;</span>",</td></tr><tr><td class="line-number" value="67"></td><td class="line-content">	":)":"<span class="html-tag">&lt;img <span class="html-attribute-name">src</span>='<a class="html-attribute-value html-resource-link" target="_blank" href="https://www.shoutbox.com/chat/smileys/(happy).gif" rel="noreferrer noopener">https://www.shoutbox.com/chat/smileys/(happy).gif</a>'&gt;</span>"</td></tr><tr><td class="line-number" value="68"></td><td class="line-content">};</td></tr><tr><td class="line-number" value="69"></td><td class="line-content">	this.parseSmileys = function(text) {</td></tr><tr><td class="line-number" value="70"></td><td class="line-content">		for (var symbol in this.smileys) {</td></tr><tr><td class="line-number" value="71"></td><td class="line-content">			var image = this.smileys[symbol];</td></tr><tr><td class="line-number" value="72"></td><td class="line-content">			text = text.replaceAll(symbol,image);</td></tr><tr><td class="line-number" value="73"></td><td class="line-content">		}</td></tr><tr><td class="line-number" value="74"></td><td class="line-content">		return text;</td></tr><tr><td class="line-number" value="75"></td><td class="line-content">	};</td></tr><tr><td class="line-number" value="76"></td><td class="line-content">		</td></tr><tr><td class="line-number" value="77"></td><td class="line-content"></td></tr><tr><td class="line-number" value="78"></td><td class="line-content">	this.stripHTML = function(html) {</td></tr><tr><td class="line-number" value="79"></td><td class="line-content">		var div = document.createElement("div");</td></tr><tr><td class="line-number" value="80"></td><td class="line-content">		div.innerHTML = html;</td></tr><tr><td class="line-number" value="81"></td><td class="line-content">		return div.textContent || div.innerText || "";		</td></tr><tr><td class="line-number" value="82"></td><td class="line-content">	};</td></tr><tr><td class="line-number" value="83"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="84"></td><td class="line-content">	this.clearChat = function() {</td></tr><tr><td class="line-number" value="85"></td><td class="line-content">		$("#shoutChat").html("");</td></tr><tr><td class="line-number" value="86"></td><td class="line-content">	};</td></tr><tr><td class="line-number" value="87"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="88"></td><td class="line-content">	this.refreshChat = function() {</td></tr><tr><td class="line-number" value="89"></td><td class="line-content">		this.clearChat();</td></tr><tr><td class="line-number" value="90"></td><td class="line-content">		var shoutbox = this;</td></tr><tr><td class="line-number" value="91"></td><td class="line-content">		$.post('https://www.shoutbox.com/chat/ajax.php',{a:'getLastMessages', id:shoutbox.myUser.room},function(data) {</td></tr><tr><td class="line-number" value="92"></td><td class="line-content">			var messages = JSON.parse(data);</td></tr><tr><td class="line-number" value="93"></td><td class="line-content">			//console.log(messages.length);</td></tr><tr><td class="line-number" value="94"></td><td class="line-content">			for (var i=messages.length-1;i&gt;=0;i--) {</td></tr><tr><td class="line-number" value="95"></td><td class="line-content">				var message = messages[i];</td></tr><tr><td class="line-number" value="96"></td><td class="line-content">				shoutbox.receiveText(message.username , message.message, message.date,0,message.avatar,message.ip, message.id);</td></tr><tr><td class="line-number" value="97"></td><td class="line-content">			}</td></tr><tr><td class="line-number" value="98"></td><td class="line-content">		});		</td></tr><tr><td class="line-number" value="99"></td><td class="line-content">	};</td></tr><tr><td class="line-number" value="100"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="101"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="102"></td><td class="line-content">	this.getLastMessages = function() {</td></tr><tr><td class="line-number" value="103"></td><td class="line-content">		var shoutbox = this;</td></tr><tr><td class="line-number" value="104"></td><td class="line-content">		$.post('https://www.shoutbox.com/chat/ajax.php',{a:'getLastMessages', id:shoutbox.myUser.room},function(data) {</td></tr><tr><td class="line-number" value="105"></td><td class="line-content">			var messages = JSON.parse(data);</td></tr><tr><td class="line-number" value="106"></td><td class="line-content">			//console.log(messages.length);</td></tr><tr><td class="line-number" value="107"></td><td class="line-content">			for (var i=messages.length-1;i&gt;=0;i--) {</td></tr><tr><td class="line-number" value="108"></td><td class="line-content">				var message = messages[i];</td></tr><tr><td class="line-number" value="109"></td><td class="line-content">				shoutbox.receiveText(message.username , message.message, message.date, 0, message.avatar, message.ip, message.id);</td></tr><tr><td class="line-number" value="110"></td><td class="line-content">			}</td></tr><tr><td class="line-number" value="111"></td><td class="line-content">			if (shoutbox.myUser.username!=='') {</td></tr><tr><td class="line-number" value="112"></td><td class="line-content">				shoutbox.welcome();</td></tr><tr><td class="line-number" value="113"></td><td class="line-content">			}</td></tr><tr><td class="line-number" value="114"></td><td class="line-content">		});</td></tr><tr><td class="line-number" value="115"></td><td class="line-content">	};</td></tr><tr><td class="line-number" value="116"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="117"></td><td class="line-content">    function keyPressedFunction(e){</td></tr><tr><td class="line-number" value="118"></td><td class="line-content">        //console.log("keyPressed");</td></tr><tr><td class="line-number" value="119"></td><td class="line-content">	  	if (!e) {</td></tr><tr><td class="line-number" value="120"></td><td class="line-content">			e = window.event;</td></tr><tr><td class="line-number" value="121"></td><td class="line-content">		}</td></tr><tr><td class="line-number" value="122"></td><td class="line-content">		    var keyCode = e.keyCode || e.which;</td></tr><tr><td class="line-number" value="123"></td><td class="line-content">    		if (keyCode == '13'){</td></tr><tr><td class="line-number" value="124"></td><td class="line-content">	      	  this.sendText();</td></tr><tr><td class="line-number" value="125"></td><td class="line-content">	    }		</td></tr><tr><td class="line-number" value="126"></td><td class="line-content">    }   </td></tr><tr><td class="line-number" value="127"></td><td class="line-content"></td></tr><tr><td class="line-number" value="128"></td><td class="line-content">    this.sendText = function() {	</td></tr><tr><td class="line-number" value="129"></td><td class="line-content">        var texte = $('#shoutBoxInput').val();</td></tr><tr><td class="line-number" value="130"></td><td class="line-content">		texte = this.stripHTML(texte);</td></tr><tr><td class="line-number" value="131"></td><td class="line-content">        if (texte==='') {</td></tr><tr><td class="line-number" value="132"></td><td class="line-content">			return;</td></tr><tr><td class="line-number" value="133"></td><td class="line-content">		}</td></tr><tr><td class="line-number" value="134"></td><td class="line-content">		// enter username</td></tr><tr><td class="line-number" value="135"></td><td class="line-content">		if (this.enteringAdminPassword) {</td></tr><tr><td class="line-number" value="136"></td><td class="line-content">			this.enteringAdminPassword = false;</td></tr><tr><td class="line-number" value="137"></td><td class="line-content">			this.shoutboxSocket.emit("checkPassword", texte);</td></tr><tr><td class="line-number" value="138"></td><td class="line-content">			$("#shoutBoxInput").removeClass("adminShoutBoxInput");</td></tr><tr><td class="line-number" value="139"></td><td class="line-content">			$('#shoutBoxInput').val('');</td></tr><tr><td class="line-number" value="140"></td><td class="line-content">			$('#shoutBoxInput').get(0).type = 'text';</td></tr><tr><td class="line-number" value="141"></td><td class="line-content">			$('#shoutBoxInput').attr("placeholder", shoutbox.traductions.enterYourTextHere);</td></tr><tr><td class="line-number" value="142"></td><td class="line-content">			return;</td></tr><tr><td class="line-number" value="143"></td><td class="line-content">		}</td></tr><tr><td class="line-number" value="144"></td><td class="line-content"></td></tr><tr><td class="line-number" value="145"></td><td class="line-content">		if (this.myUser.username==='') {</td></tr><tr><td class="line-number" value="146"></td><td class="line-content">			this.myUser.username = texte;</td></tr><tr><td class="line-number" value="147"></td><td class="line-content">			$('#shoutBoxInput').val("");</td></tr><tr><td class="line-number" value="148"></td><td class="line-content">			shoutbox.welcome();</td></tr><tr><td class="line-number" value="149"></td><td class="line-content">			shoutbox.shoutboxSocket.emit('changeUser', shoutbox.myUser);</td></tr><tr><td class="line-number" value="150"></td><td class="line-content">			return;</td></tr><tr><td class="line-number" value="151"></td><td class="line-content">		}</td></tr><tr><td class="line-number" value="152"></td><td class="line-content">        $('#shoutBoxInput').val('');</td></tr><tr><td class="line-number" value="153"></td><td class="line-content">        this.shoutboxSocket.emit('send', this.myUser, texte);</td></tr><tr><td class="line-number" value="154"></td><td class="line-content">		   </td></tr><tr><td class="line-number" value="155"></td><td class="line-content">    };</td></tr><tr><td class="line-number" value="156"></td><td class="line-content">	this.welcome = function() {</td></tr><tr><td class="line-number" value="157"></td><td class="line-content">		$('#shoutBoxInput').attr("placeholder", shoutbox.traductions.enterYourTextHere);</td></tr><tr><td class="line-number" value="158"></td><td class="line-content">		localStorage.setItem("username", this.myUser.username);</td></tr><tr><td class="line-number" value="159"></td><td class="line-content">		this.serverMessage(sprintf(shoutbox.traductions.welcome, this.myUser.username));</td></tr><tr><td class="line-number" value="160"></td><td class="line-content">		$("#shoutBoxInput").removeClass("shoutInputRed");</td></tr><tr><td class="line-number" value="161"></td><td class="line-content">		localStorage.setItem('username', this.myUser.username);</td></tr><tr><td class="line-number" value="162"></td><td class="line-content">	};</td></tr><tr><td class="line-number" value="163"></td><td class="line-content"></td></tr><tr><td class="line-number" value="164"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="165"></td><td class="line-content">	this.serverMessage = function(texte) {</td></tr><tr><td class="line-number" value="166"></td><td class="line-content"></td></tr><tr><td class="line-number" value="167"></td><td class="line-content">		$("#shoutChat").append(sprintf(shoutbox.traductions.serverMessage, texte));</td></tr><tr><td class="line-number" value="168"></td><td class="line-content">		$("#shoutChat").animate({ scrollTop: $("#shoutChat")[0].scrollHeight}, 1000);</td></tr><tr><td class="line-number" value="169"></td><td class="line-content">	};</td></tr><tr><td class="line-number" value="170"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="171"></td><td class="line-content">    this.receiveText = function(username, message, date, scrollTimer, avatar, ip, id) {  </td></tr><tr><td class="line-number" value="172"></td><td class="line-content">		message = shoutbox.parseSmileys(message);</td></tr><tr><td class="line-number" value="173"></td><td class="line-content">		if (avatar!=="") {</td></tr><tr><td class="line-number" value="174"></td><td class="line-content">			avatar = sprintf(shoutbox.traductions.imageAvatar, avatar);</td></tr><tr><td class="line-number" value="175"></td><td class="line-content">		}</td></tr><tr><td class="line-number" value="176"></td><td class="line-content">		if (date!=='') {</td></tr><tr><td class="line-number" value="177"></td><td class="line-content">			date="("+date+")";</td></tr><tr><td class="line-number" value="178"></td><td class="line-content">		}</td></tr><tr><td class="line-number" value="179"></td><td class="line-content">		var text = sprintf(shoutbox.traductions.receivedText, id, ip, avatar, date, username, message);</td></tr><tr><td class="line-number" value="180"></td><td class="line-content">		//console.log(text);</td></tr><tr><td class="line-number" value="181"></td><td class="line-content"></td></tr><tr><td class="line-number" value="182"></td><td class="line-content">		$("#shoutChat").animate({ scrollTop: $("#shoutChat")[0].scrollHeight}, scrollTimer);	</td></tr><tr><td class="line-number" value="183"></td><td class="line-content">		$(text).hide().appendTo("#shoutChat").fadeIn(2000);   </td></tr><tr><td class="line-number" value="184"></td><td class="line-content">    };</td></tr><tr><td class="line-number" value="185"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="186"></td><td class="line-content">	this.addUser = function(user) {</td></tr><tr><td class="line-number" value="187"></td><td class="line-content">		if (user.username==='') {</td></tr><tr><td class="line-number" value="188"></td><td class="line-content">			user.username='Guest';</td></tr><tr><td class="line-number" value="189"></td><td class="line-content">		}</td></tr><tr><td class="line-number" value="190"></td><td class="line-content">		this.updateNumberUsersDisplay();</td></tr><tr><td class="line-number" value="191"></td><td class="line-content">		var avatar = user.avatar;</td></tr><tr><td class="line-number" value="192"></td><td class="line-content">		if (avatar!=='') {</td></tr><tr><td class="line-number" value="193"></td><td class="line-content">			var image  = user.avatar || 'avatars/' + Math.ceil(Math.random()*29) + '.svg';</td></tr><tr><td class="line-number" value="194"></td><td class="line-content">			avatar = sprintf(shoutbox.traductions.imageAvatar, image);</td></tr><tr><td class="line-number" value="195"></td><td class="line-content">		}</td></tr><tr><td class="line-number" value="196"></td><td class="line-content">		var txt = sprintf(shoutbox.traductions.addUser, user.id, user.id, avatar, user.username);</td></tr><tr><td class="line-number" value="197"></td><td class="line-content">		//console.log(user);</td></tr><tr><td class="line-number" value="198"></td><td class="line-content">		//console.log("shoutBoxUserList"+txt);</td></tr><tr><td class="line-number" value="199"></td><td class="line-content">		$('#shoutBoxUserList').append(txt);</td></tr><tr><td class="line-number" value="200"></td><td class="line-content">		</td></tr><tr><td class="line-number" value="201"></td><td class="line-content">	};</td></tr><tr><td class="line-number" value="202"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="203"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="204"></td><td class="line-content">//******************************************* init ********************************************</td></tr><tr><td class="line-number" value="205"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="206"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="207"></td><td class="line-content">    document.getElementById('shoutBoxInput').addEventListener("keypress", keyPressedFunction.bind(this), false);</td></tr><tr><td class="line-number" value="208"></td><td class="line-content">	this.getLastMessages();</td></tr><tr><td class="line-number" value="209"></td><td class="line-content">	this.users = [];</td></tr><tr><td class="line-number" value="210"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="211"></td><td class="line-content">	this.shoutboxSocket = io.connect(server+":1400");</td></tr><tr><td class="line-number" value="212"></td><td class="line-content">	this.shoutboxSocket.on('connect', function() {</td></tr><tr><td class="line-number" value="213"></td><td class="line-content">		var username = localStorage.getItem('username');</td></tr><tr><td class="line-number" value="214"></td><td class="line-content">		if(username) {</td></tr><tr><td class="line-number" value="215"></td><td class="line-content">			shoutbox.myUser.username = username;</td></tr><tr><td class="line-number" value="216"></td><td class="line-content">		}</td></tr><tr><td class="line-number" value="217"></td><td class="line-content">		shoutbox.shoutboxSocket.emit('enterRoom', shoutbox.myUser);</td></tr><tr><td class="line-number" value="218"></td><td class="line-content">	});</td></tr><tr><td class="line-number" value="219"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="220"></td><td class="line-content">	this.shoutboxSocket.on('roomEntered', function () {</td></tr><tr><td class="line-number" value="221"></td><td class="line-content">		var username = localStorage.getItem('username');</td></tr><tr><td class="line-number" value="222"></td><td class="line-content">		if (username) {</td></tr><tr><td class="line-number" value="223"></td><td class="line-content">			shoutbox.welcome();</td></tr><tr><td class="line-number" value="224"></td><td class="line-content">		}</td></tr><tr><td class="line-number" value="225"></td><td class="line-content">	});</td></tr><tr><td class="line-number" value="226"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="227"></td><td class="line-content">	this.shoutboxSocket.on('del', function (id) {</td></tr><tr><td class="line-number" value="228"></td><td class="line-content">		$('*[data-id='+id+']').remove();		</td></tr><tr><td class="line-number" value="229"></td><td class="line-content">	});</td></tr><tr><td class="line-number" value="230"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="231"></td><td class="line-content">	this.shoutboxSocket.on('ban', function (ip) {</td></tr><tr><td class="line-number" value="232"></td><td class="line-content">		$('*[data-ip='+ip+']').remove();		</td></tr><tr><td class="line-number" value="233"></td><td class="line-content">	});	</td></tr><tr><td class="line-number" value="234"></td><td class="line-content">		</td></tr><tr><td class="line-number" value="235"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="236"></td><td class="line-content">	this.shoutboxSocket.on('receiveText', function (user, message, ip, id) {</td></tr><tr><td class="line-number" value="237"></td><td class="line-content">		shoutbox.receiveText(user.username, message , "",200,user.avatar, ip, id);</td></tr><tr><td class="line-number" value="238"></td><td class="line-content">		var snd = new Audio(shoutbox.traductions.mp3);</td></tr><tr><td class="line-number" value="239"></td><td class="line-content">		snd.play();		</td></tr><tr><td class="line-number" value="240"></td><td class="line-content">	});</td></tr><tr><td class="line-number" value="241"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="242"></td><td class="line-content">	this.setAdminMode = function(password) {</td></tr><tr><td class="line-number" value="243"></td><td class="line-content">		this.myUser.password = password;</td></tr><tr><td class="line-number" value="244"></td><td class="line-content">		shoutbox.serverMessage(shoutbox.traductions.youAreAdminNow);</td></tr><tr><td class="line-number" value="245"></td><td class="line-content">		$("#shoutBoxAdminImage").toggle();</td></tr><tr><td class="line-number" value="246"></td><td class="line-content">	};</td></tr><tr><td class="line-number" value="247"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="248"></td><td class="line-content"></td></tr><tr><td class="line-number" value="249"></td><td class="line-content">	$( ".shoutBoxContainer").on( "click", ".shoutboxBanBtn", function() {</td></tr><tr><td class="line-number" value="250"></td><td class="line-content">		var ip = ($(this).parent().data("ip"));</td></tr><tr><td class="line-number" value="251"></td><td class="line-content">	  	shoutbox.shoutboxSocket.emit("ban", ip);</td></tr><tr><td class="line-number" value="252"></td><td class="line-content">	});</td></tr><tr><td class="line-number" value="253"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="254"></td><td class="line-content">	$( ".shoutBoxContainer").on( "click", ".shoutboxDelBtn", function() {</td></tr><tr><td class="line-number" value="255"></td><td class="line-content">		var id = ($(this).parent().data("id"));</td></tr><tr><td class="line-number" value="256"></td><td class="line-content">	  	shoutbox.shoutboxSocket.emit("del", id);</td></tr><tr><td class="line-number" value="257"></td><td class="line-content">	});</td></tr><tr><td class="line-number" value="258"></td><td class="line-content">		</td></tr><tr><td class="line-number" value="259"></td><td class="line-content">		</td></tr><tr><td class="line-number" value="260"></td><td class="line-content">		</td></tr><tr><td class="line-number" value="261"></td><td class="line-content"></td></tr><tr><td class="line-number" value="262"></td><td class="line-content">	this.shoutboxSocket.on('userChanged', function (user) {</td></tr><tr><td class="line-number" value="263"></td><td class="line-content">		var avatar = user.avatar;</td></tr><tr><td class="line-number" value="264"></td><td class="line-content">		if (avatar!=='') {</td></tr><tr><td class="line-number" value="265"></td><td class="line-content">			avatar = sprintf(shoutbox.traductions.imageAvatar, avatar);</td></tr><tr><td class="line-number" value="266"></td><td class="line-content">		}		</td></tr><tr><td class="line-number" value="267"></td><td class="line-content">		var txt = sprintf(shoutbox.traductions.addUser, user.id, user.id, avatar, user.username);</td></tr><tr><td class="line-number" value="268"></td><td class="line-content">		//console.log(txt);</td></tr><tr><td class="line-number" value="269"></td><td class="line-content">		$("#shoutBoxUser"+user.id).html(txt);</td></tr><tr><td class="line-number" value="270"></td><td class="line-content">	});	</td></tr><tr><td class="line-number" value="271"></td><td class="line-content"></td></tr><tr><td class="line-number" value="272"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="273"></td><td class="line-content">	this.shoutboxSocket.on('setAdminMode', function (password) {</td></tr><tr><td class="line-number" value="274"></td><td class="line-content">		shoutbox.setAdminMode(password);</td></tr><tr><td class="line-number" value="275"></td><td class="line-content">		$(".shoutboxBanBtn").css("display","block");</td></tr><tr><td class="line-number" value="276"></td><td class="line-content">		$(".shoutboxDelBtn").css("display","block");</td></tr><tr><td class="line-number" value="277"></td><td class="line-content">	});	</td></tr><tr><td class="line-number" value="278"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="279"></td><td class="line-content">	this.shoutboxSocket.on('error', function (errorMessage) {</td></tr><tr><td class="line-number" value="280"></td><td class="line-content">		console.log(errorMessage);</td></tr><tr><td class="line-number" value="281"></td><td class="line-content">	});</td></tr><tr><td class="line-number" value="282"></td><td class="line-content"></td></tr><tr><td class="line-number" value="283"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="284"></td><td class="line-content">	this.shoutboxSocket.on('addUser', function(user) {</td></tr><tr><td class="line-number" value="285"></td><td class="line-content">		shoutbox.users[user.id] = user;</td></tr><tr><td class="line-number" value="286"></td><td class="line-content">		shoutbox.addUser(user);</td></tr><tr><td class="line-number" value="287"></td><td class="line-content">	});</td></tr><tr><td class="line-number" value="288"></td><td class="line-content">	$(document).on('click', ".changeUsernameBtn", function() {</td></tr><tr><td class="line-number" value="289"></td><td class="line-content">        localStorage.clear();</td></tr><tr><td class="line-number" value="290"></td><td class="line-content">		shoutbox.myUser.username = '';</td></tr><tr><td class="line-number" value="291"></td><td class="line-content">		$("#shoutBoxInput").addClass("shoutInputRed");</td></tr><tr><td class="line-number" value="292"></td><td class="line-content">		$('#shoutBoxInput').val('');</td></tr><tr><td class="line-number" value="293"></td><td class="line-content">		$('#shoutBoxInput').attr("placeholder", 'Enter new nickname');</td></tr><tr><td class="line-number" value="294"></td><td class="line-content">    });</td></tr><tr><td class="line-number" value="295"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="296"></td><td class="line-content">	this.updateNumberUsersDisplay = function() {</td></tr><tr><td class="line-number" value="297"></td><td class="line-content">        var len =  Object.keys(shoutbox.users).length;</td></tr><tr><td class="line-number" value="298"></td><td class="line-content">		var text = sprintf(shoutbox.traductions.userOnline, len);</td></tr><tr><td class="line-number" value="299"></td><td class="line-content">		if (shoutbox.users.length&gt;1) {</td></tr><tr><td class="line-number" value="300"></td><td class="line-content">			text = sprintf(shoutbox.traductions.usersOnline, len);</td></tr><tr><td class="line-number" value="301"></td><td class="line-content">		}</td></tr><tr><td class="line-number" value="302"></td><td class="line-content">		$("#shoutBoxHeaderText").text(text);</td></tr><tr><td class="line-number" value="303"></td><td class="line-content">	};</td></tr><tr><td class="line-number" value="304"></td><td class="line-content"></td></tr><tr><td class="line-number" value="305"></td><td class="line-content">	this.shoutboxSocket.on('getUsers', function(usersInRoom) {</td></tr><tr><td class="line-number" value="306"></td><td class="line-content">		// convert to array !</td></tr><tr><td class="line-number" value="307"></td><td class="line-content">		//console.log("usersInRoom="+usersInRoom+ "len=" + usersInRoom.length);</td></tr><tr><td class="line-number" value="308"></td><td class="line-content">		shoutbox.users = usersInRoom;</td></tr><tr><td class="line-number" value="309"></td><td class="line-content">		shoutbox.updateNumberUsersDisplay();</td></tr><tr><td class="line-number" value="310"></td><td class="line-content">		//shoutbox.sortUsers();</td></tr><tr><td class="line-number" value="311"></td><td class="line-content">        for (var id in usersInRoom) {</td></tr><tr><td class="line-number" value="312"></td><td class="line-content">            shoutbox.addUser(usersInRoom[id]);</td></tr><tr><td class="line-number" value="313"></td><td class="line-content">        }</td></tr><tr><td class="line-number" value="314"></td><td class="line-content"></td></tr><tr><td class="line-number" value="315"></td><td class="line-content">	});</td></tr><tr><td class="line-number" value="316"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="317"></td><td class="line-content">	this.sortUsers = function() {</td></tr><tr><td class="line-number" value="318"></td><td class="line-content">		shoutbox.users.sort(function(user1, user2) {</td></tr><tr><td class="line-number" value="319"></td><td class="line-content">   			return user1.avatar &lt; user2.avatar;</td></tr><tr><td class="line-number" value="320"></td><td class="line-content">		});</td></tr><tr><td class="line-number" value="321"></td><td class="line-content">	};</td></tr><tr><td class="line-number" value="322"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="323"></td><td class="line-content">	this.shoutboxSocket.on('removeUser', function(user) {</td></tr><tr><td class="line-number" value="324"></td><td class="line-content">		delete shoutbox.users[user.id];</td></tr><tr><td class="line-number" value="325"></td><td class="line-content">		shoutbox.updateNumberUsersDisplay();</td></tr><tr><td class="line-number" value="326"></td><td class="line-content">		$("#shoutBoxUser"+user.id).remove();</td></tr><tr><td class="line-number" value="327"></td><td class="line-content">		</td></tr><tr><td class="line-number" value="328"></td><td class="line-content">	});	</td></tr><tr><td class="line-number" value="329"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="330"></td><td class="line-content">	$(".shoutBoxContainer").on( "click", ".shoutBoxUserItem", function(e) {	</td></tr><tr><td class="line-number" value="331"></td><td class="line-content">		e.stopImmediatePropagation();</td></tr><tr><td class="line-number" value="332"></td><td class="line-content">		var userid = ($(e.currentTarget).data("id"));</td></tr><tr><td class="line-number" value="333"></td><td class="line-content">		shoutbox.openPrivateChat(userid);</td></tr><tr><td class="line-number" value="334"></td><td class="line-content">	});</td></tr><tr><td class="line-number" value="335"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="336"></td><td class="line-content">	this.openPrivateChat = function(userid) {</td></tr><tr><td class="line-number" value="337"></td><td class="line-content">		//$("body").append("<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>='<span class="html-attribute-value">privateChat</span>'&gt;</span>zaza<span class="html-tag">&lt;/div&gt;</span>");</td></tr><tr><td class="line-number" value="338"></td><td class="line-content">	};</td></tr><tr><td class="line-number" value="339"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="340"></td><td class="line-content">	this.displayError = function($_element, message) {</td></tr><tr><td class="line-number" value="341"></td><td class="line-content">		$_element.html(message);</td></tr><tr><td class="line-number" value="342"></td><td class="line-content">		setTimeout(function() {</td></tr><tr><td class="line-number" value="343"></td><td class="line-content">			$_element.empty();			</td></tr><tr><td class="line-number" value="344"></td><td class="line-content">		},3000);</td></tr><tr><td class="line-number" value="345"></td><td class="line-content">	};</td></tr><tr><td class="line-number" value="346"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="347"></td><td class="line-content">	$("#forgottenBtn").click(function() {</td></tr><tr><td class="line-number" value="348"></td><td class="line-content">        $("#forgottenPassword").slideToggle(200);</td></tr><tr><td class="line-number" value="349"></td><td class="line-content">    });</td></tr><tr><td class="line-number" value="350"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="351"></td><td class="line-content">	$("#saveBtn").click(function() {</td></tr><tr><td class="line-number" value="352"></td><td class="line-content">    	var $_element = $(this).parent().parent().find(".error");</td></tr><tr><td class="line-number" value="353"></td><td class="line-content">    	var userMustRegister = $("#userMustRegister").is(':checked');</td></tr><tr><td class="line-number" value="354"></td><td class="line-content">		var password = $("#changePassword1").val(); </td></tr><tr><td class="line-number" value="355"></td><td class="line-content">		var password2 = $("#changePassword2").val(); </td></tr><tr><td class="line-number" value="356"></td><td class="line-content">		if (password.length&lt;3 || password!==password2) {</td></tr><tr><td class="line-number" value="357"></td><td class="line-content">			shoutbox.displayError($_element , "Invalid Password");</td></tr><tr><td class="line-number" value="358"></td><td class="line-content">			return;</td></tr><tr><td class="line-number" value="359"></td><td class="line-content">		}</td></tr><tr><td class="line-number" value="360"></td><td class="line-content">		$(".error").empty();</td></tr><tr><td class="line-number" value="361"></td><td class="line-content">		$.ajax({</td></tr><tr><td class="line-number" value="362"></td><td class="line-content">			type: 'POST',</td></tr><tr><td class="line-number" value="363"></td><td class="line-content">			url: 'https://www.shoutbox.com/chat/ajax.php',</td></tr><tr><td class="line-number" value="364"></td><td class="line-content">			crossDomain: true,</td></tr><tr><td class="line-number" value="365"></td><td class="line-content">			data: {a:'updateAdmin', userMustRegister:userMustRegister, password:password},</td></tr><tr><td class="line-number" value="366"></td><td class="line-content">			success: function (user) {</td></tr><tr><td class="line-number" value="367"></td><td class="line-content">				if(user==="ko") {</td></tr><tr><td class="line-number" value="368"></td><td class="line-content">					shoutbox.displayError($_element , "Invalid email/password");</td></tr><tr><td class="line-number" value="369"></td><td class="line-content">					return;</td></tr><tr><td class="line-number" value="370"></td><td class="line-content">				}</td></tr><tr><td class="line-number" value="371"></td><td class="line-content">				user = JSON.parse(user);</td></tr><tr><td class="line-number" value="372"></td><td class="line-content">				shoutbox.myUser.password = user.password;</td></tr><tr><td class="line-number" value="373"></td><td class="line-content">				shoutbox.myUser.userMustRegister = user.userMustRegister;</td></tr><tr><td class="line-number" value="374"></td><td class="line-content">				$("#configPanel2").slideToggle(200);</td></tr><tr><td class="line-number" value="375"></td><td class="line-content">				$("#configPanel").hide();</td></tr><tr><td class="line-number" value="376"></td><td class="line-content">			}</td></tr><tr><td class="line-number" value="377"></td><td class="line-content">	    });					</td></tr><tr><td class="line-number" value="378"></td><td class="line-content">    });</td></tr><tr><td class="line-number" value="379"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="380"></td><td class="line-content">	$('#loginAdminBtn').click(function() {</td></tr><tr><td class="line-number" value="381"></td><td class="line-content">		var $_element = $(this).parent().parent().find('.error');</td></tr><tr><td class="line-number" value="382"></td><td class="line-content">        var email = $('#emailAdmin').val();</td></tr><tr><td class="line-number" value="383"></td><td class="line-content">		var password = $('#passwordAdmin').val();</td></tr><tr><td class="line-number" value="384"></td><td class="line-content">		if (password.length&lt;3) {</td></tr><tr><td class="line-number" value="385"></td><td class="line-content">			shoutbox.displayError($_element , 'Invalid Password');</td></tr><tr><td class="line-number" value="386"></td><td class="line-content">			return;</td></tr><tr><td class="line-number" value="387"></td><td class="line-content">		}</td></tr><tr><td class="line-number" value="388"></td><td class="line-content">		var re = /^(([^&lt;&gt;()[\]\\.,;:\s@"]+(\.[^&lt;&gt;()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;</td></tr><tr><td class="line-number" value="389"></td><td class="line-content">    	if (!re.test(email)) {</td></tr><tr><td class="line-number" value="390"></td><td class="line-content">			shoutbox.displayError($_element, 'Invalid email');</td></tr><tr><td class="line-number" value="391"></td><td class="line-content">			return;</td></tr><tr><td class="line-number" value="392"></td><td class="line-content">		}</td></tr><tr><td class="line-number" value="393"></td><td class="line-content">		$('.error').empty();</td></tr><tr><td class="line-number" value="394"></td><td class="line-content">		$.ajax({</td></tr><tr><td class="line-number" value="395"></td><td class="line-content">			type: 'POST',</td></tr><tr><td class="line-number" value="396"></td><td class="line-content">			url: 'https://www.shoutbox.com/chat/ajax.php',</td></tr><tr><td class="line-number" value="397"></td><td class="line-content">			crossDomain: true,</td></tr><tr><td class="line-number" value="398"></td><td class="line-content">			data: {a:'loginAdmin', email:email, password:password},</td></tr><tr><td class="line-number" value="399"></td><td class="line-content">			success: function (user) {</td></tr><tr><td class="line-number" value="400"></td><td class="line-content">				if(user==="ko") {</td></tr><tr><td class="line-number" value="401"></td><td class="line-content">					shoutbox.displayError($_element , "Invalid email/password");</td></tr><tr><td class="line-number" value="402"></td><td class="line-content">					return;</td></tr><tr><td class="line-number" value="403"></td><td class="line-content">				}</td></tr><tr><td class="line-number" value="404"></td><td class="line-content">				user = JSON.parse(user);</td></tr><tr><td class="line-number" value="405"></td><td class="line-content">				shoutbox.myUser.username = "admin";</td></tr><tr><td class="line-number" value="406"></td><td class="line-content">				shoutbox.myUser.password = user.password;</td></tr><tr><td class="line-number" value="407"></td><td class="line-content">				shoutbox.myUser.userMustRegister = user.userMustRegister;</td></tr><tr><td class="line-number" value="408"></td><td class="line-content">				shoutbox.myUser.isAdmin = true;</td></tr><tr><td class="line-number" value="409"></td><td class="line-content">				shoutbox.myUser.avatar = 'https://www.shoutbox.com/avatars/admin.svg';</td></tr><tr><td class="line-number" value="410"></td><td class="line-content">				$("#configPanel2").slideToggle(200);</td></tr><tr><td class="line-number" value="411"></td><td class="line-content">				shoutbox.serverMessage(shoutbox.traductions.youAreAdminNow);</td></tr><tr><td class="line-number" value="412"></td><td class="line-content">			}</td></tr><tr><td class="line-number" value="413"></td><td class="line-content">	    });		</td></tr><tr><td class="line-number" value="414"></td><td class="line-content">	});</td></tr><tr><td class="line-number" value="415"></td><td class="line-content">	$("#sendMyPasswordBtn").click(function() {</td></tr><tr><td class="line-number" value="416"></td><td class="line-content">        var $_element = $(this).parent().parent().find(".error");</td></tr><tr><td class="line-number" value="417"></td><td class="line-content">		var re = /^(([^&lt;&gt;()[\]\\.,;:\s@"]+(\.[^&lt;&gt;()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;</td></tr><tr><td class="line-number" value="418"></td><td class="line-content">    	var email = $("#forgottenEmail").val();</td></tr><tr><td class="line-number" value="419"></td><td class="line-content">		if (!re.test(email)) {</td></tr><tr><td class="line-number" value="420"></td><td class="line-content">			shoutbox.displayError($_element, "Invalid email");</td></tr><tr><td class="line-number" value="421"></td><td class="line-content">			return;</td></tr><tr><td class="line-number" value="422"></td><td class="line-content">		}</td></tr><tr><td class="line-number" value="423"></td><td class="line-content">		$.ajax({</td></tr><tr><td class="line-number" value="424"></td><td class="line-content">			type: 'POST',</td></tr><tr><td class="line-number" value="425"></td><td class="line-content">			url: 'https://www.shoutbox.com/chat/ajax.php',</td></tr><tr><td class="line-number" value="426"></td><td class="line-content">			crossDomain: true,</td></tr><tr><td class="line-number" value="427"></td><td class="line-content">			data: {a:'forgottenPasswordAdmin', email:email},</td></tr><tr><td class="line-number" value="428"></td><td class="line-content">			success: function (res) {</td></tr><tr><td class="line-number" value="429"></td><td class="line-content">				if(res==="ko") {</td></tr><tr><td class="line-number" value="430"></td><td class="line-content">					shoutbox.displayError($_element , "No such email !");</td></tr><tr><td class="line-number" value="431"></td><td class="line-content">					return;</td></tr><tr><td class="line-number" value="432"></td><td class="line-content">				}</td></tr><tr><td class="line-number" value="433"></td><td class="line-content">				$("#forgottenPassword").hide(200);</td></tr><tr><td class="line-number" value="434"></td><td class="line-content">			}</td></tr><tr><td class="line-number" value="435"></td><td class="line-content">	    });				</td></tr><tr><td class="line-number" value="436"></td><td class="line-content">		</td></tr><tr><td class="line-number" value="437"></td><td class="line-content">    });</td></tr><tr><td class="line-number" value="438"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="439"></td><td class="line-content">	$("#shoutBoxAdminImage").click(function(e) {</td></tr><tr><td class="line-number" value="440"></td><td class="line-content">		e.stopImmediatePropagation();</td></tr><tr><td class="line-number" value="441"></td><td class="line-content">		$("#configPanel").slideToggle(200);</td></tr><tr><td class="line-number" value="442"></td><td class="line-content">		$("#configPanel2").hide();</td></tr><tr><td class="line-number" value="443"></td><td class="line-content">		$("#forgottenPassword").hide();</td></tr><tr><td class="line-number" value="444"></td><td class="line-content">    });</td></tr><tr><td class="line-number" value="445"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="446"></td><td class="line-content">	$("#shoutBoxHeader").click(function() {</td></tr><tr><td class="line-number" value="447"></td><td class="line-content">    	$("#shoutBoxUserList").toggle("fast");</td></tr><tr><td class="line-number" value="448"></td><td class="line-content">		</td></tr><tr><td class="line-number" value="449"></td><td class="line-content">	});</td></tr><tr><td class="line-number" value="450"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="451"></td><td class="line-content">};<span class="html-end-of-file"></span></td></tr></tbody></table></body></html>